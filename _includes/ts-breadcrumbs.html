{% unless page.url == '/' or page.url == '/index.html' %}
{%- assign is_home = page.url == '/' or page.url == '/index.html' -%}
{%- assign render_breadcrumbs = true -%}
<<<<<<< HEAD
{%- if is_home
    or (page.show_breadcrumbs != nil and page.show_breadcrumbs == false)
    or (page.breadcrumb != nil and page.breadcrumb == false) -%}
=======
{%- if is_home or page.show_breadcrumbs == false -%}
>>>>>>> cd94431d4595c868507e3ce0fccbb2a3869edcde
  {%- assign render_breadcrumbs = false -%}
{%- endif -%}

{%- if render_breadcrumbs -%}
<<<<<<< HEAD
  {%- assign raw_url = page.url | default: '' -%}
  {%- assign clean_url = '' | append: raw_url | replace: 'index.html', '' | replace: '.html', '' -%}
  {%- assign segments = clean_url | split: '/' -%}
  {%- assign clean_segments_list = '' -%}
  {%- for seg in segments -%}
    {%- unless seg == '' -%}
      {%- if clean_segments_list == '' -%}
        {%- assign clean_segments_list = seg -%}
      {%- else -%}
        {%- assign clean_segments_list = clean_segments_list | append: '|' | append: seg -%}
      {%- endif -%}
    {%- endunless -%}
  {%- endfor -%}
  {%- if clean_segments_list != '' -%}
    {%- assign clean_segments = clean_segments_list | split: '|' -%}
  {%- else -%}
    {%- assign clean_segments = '' | split: '' -%}
  {%- endif -%}

  {%- assign is_post = false -%}
  {%- if page.collection == 'posts' or page.layout == 'post' -%}
    {%- assign is_post = true -%}
  {%- endif -%}

  {%- assign parent_url = page.parent | default: page.breadcrumb_parent -%}
  {%- if is_post and (parent_url == blank or parent_url == nil) -%}
    {%- assign parent_url = '/blog/' -%}
  {%- endif -%}
  {%- assign parent_label = page.parent_label | default: page.breadcrumb_parent_label -%}
  {%- assign parent_page = nil -%}
  {%- assign parent_path = '' -%}
  {%- assign parent_slug = nil -%}

  {%- if parent_url and parent_url != '' -%}
    {%- assign parent_clean = parent_url | replace: 'index.html', '' | replace: '.html', '' -%}
    {%- assign parent_segments = parent_clean | split: '/' -%}
    {%- for part in parent_segments -%}
      {%- unless part == '' -%}
        {%- assign parent_path = parent_path | append: '/' | append: part -%}
        {%- assign parent_slug = part -%}
      {%- endunless -%}
    {%- endfor -%}
    {%- assign parent_slug = parent_slug | default: '' -%}
    {%- assign lookup_url = parent_url -%}
    {%- assign parent_page = site.html_pages | where_exp: 'p', 'p.url == lookup_url' | first -%}
    {%- if parent_page == nil and parent_path != '' -%}
      {%- assign lookup_url = parent_path | append: '/' -%}
      {%- assign parent_page = site.html_pages | where_exp: 'p', 'p.url == lookup_url' | first -%}
    {%- endif -%}
    {%- if parent_page and parent_label == nil -%}
      {%- assign parent_label = parent_page.breadcrumb_title | default: parent_page.title -%}
    {%- endif -%}
    {%- if parent_label == nil and parent_slug -%}
      {%- assign parent_label = parent_slug | replace: '-', ' ' | capitalize -%}
    {%- endif -%}
  {%- endif -%}

  {%- assign parent_slug = parent_slug | default: '' -%}
  {%- if parent_label -%}
    {%- if parent_label contains '|' -%}
      {%- assign parent_label = parent_label | split: '|' | first -%}
    {%- endif -%}
    {%- assign parent_label = parent_label | strip -%}
  {%- endif -%}

  {%- assign segments_to_skip = 0 -%}
  {%- if is_post and clean_segments.size > 0 -%}
    {%- assign segments_to_skip = clean_segments.size | minus: 1 -%}
  {%- endif -%}
  {%- if segments_to_skip < 0 -%}
    {%- assign segments_to_skip = 0 -%}
  {%- endif -%}
  {%- assign last_index = clean_segments.size | minus: 1 -%}
  {%- assign has_trail = false -%}
  {%- if parent_label -%}
    {%- if parent_path != '' -%}
      {%- assign has_trail = true -%}
    {%- endif -%}
  {%- endif -%}
  {%- if has_trail == false -%}
    {%- for segment in clean_segments -%}
      {%- if is_post and forloop.index0 < segments_to_skip -%}
        {%- continue -%}
      {%- endif -%}
      {%- if parent_slug != '' and segment == parent_slug -%}
        {%- continue -%}
      {%- endif -%}
      {%- assign has_trail = true -%}
      {%- break -%}
    {%- endfor -%}
  {%- endif -%}

  {%- if has_trail -%}
    {%- assign json_items = '' -%}
    {%- assign json_sep = '' -%}
    {%- assign home_absolute = '/' | absolute_url -%}
    {%- assign home_entry = '{"@type":"ListItem","position":1,"name":"Home","item":' | append: home_absolute | strip | jsonify | append: '}' -%}
    {%- assign json_items = json_items | append: home_entry -%}
    {%- assign json_sep = ',' -%}
    {%- assign crumb_position = 2 -%}
    {%- assign current_path = '' -%}

    <div class="breadcrumbs-bar">
      <nav class="breadcrumbs ts-breadcrumbs" aria-label="Breadcrumb" role="navigation">
        <ol class="breadcrumbs-list ts-breadcrumbs__list" itemscope itemtype="https://schema.org/BreadcrumbList">
          {%- assign home_relative = '/' | relative_url -%}
          <li class="breadcrumbs-item ts-breadcrumbs__item" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
            <a class="breadcrumbs-link ts-breadcrumbs__link ts-crumb-link" href="{{ home_relative }}" itemprop="item">
              <span itemprop="name">Home</span>
            </a>
            <meta itemprop="position" content="1">
          </li>

          {%- if parent_label -%}
            {%- if parent_path != '' -%}
            {%- assign parent_href = parent_path | append: '/' -%}
            {%- assign parent_relative = parent_href | relative_url -%}
            {%- assign parent_absolute = parent_href | absolute_url -%}
            <li class="breadcrumbs-item ts-breadcrumbs__item" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
              <a class="breadcrumbs-link ts-breadcrumbs__link ts-crumb-link" href="{{ parent_relative }}" itemprop="item">
                <span itemprop="name">{{ parent_label }}</span>
              </a>
              <meta itemprop="position" content="{{ crumb_position }}">
            </li>
            {%- assign parent_entry = '{"@type":"ListItem","position":' | append: crumb_position | append: ',"name":' | append: parent_label | strip | jsonify | append: ',"item":' | append: parent_absolute | strip | jsonify | append: '}' -%}
            {%- assign json_items = json_items | append: json_sep | append: parent_entry -%}
            {%- assign json_sep = ',' -%}
            {%- assign crumb_position = crumb_position | plus: 1 -%}
            {%- assign current_path = parent_path -%}
            {%- endif -%}
          {%- endif -%}

          {%- for segment in clean_segments -%}
            {%- if is_post and forloop.index0 < segments_to_skip -%}
              {%- continue -%}
            {%- endif -%}
            {%- if parent_slug != '' and segment == parent_slug -%}
              {%- continue -%}
            {%- endif -%}
            {%- assign current_path = current_path | append: '/' | append: segment -%}
            {%- assign crumb_href = current_path | append: '/' -%}
            {%- assign is_last_segment = forloop.index0 == last_index -%}
            {%- if is_post and is_last_segment -%}
              {%- assign crumb_href = page.url -%}
            {%- endif -%}
            {%- assign crumb_page = nil -%}
            {%- unless is_post and is_last_segment -%}
              {%- assign crumb_page = site.html_pages | where_exp: 'p', 'p.url == crumb_href' | first -%}
            {%- endunless -%}
            {%- if is_last_segment == false and crumb_page == nil -%}
              {%- continue -%}
            {%- endif -%}
            {%- assign base_label = segment | replace: '-', ' ' | strip | capitalize -%}
            {%- if is_last_segment -%}
              {%- assign label_source = page.breadcrumb_title | default: page.breadcrumb_label | default: page.title | default: base_label -%}
              {%- assign label = label_source -%}
              {%- if label contains '|' -%}
                {%- assign label = label | split: '|' | first -%}
              {%- endif -%}
              {%- assign label = label | strip -%}
              {%- if label == '' -%}
                {%- assign label = base_label -%}
              {%- endif -%}
            {%- else -%}
              {%- if crumb_page -%}
                {%- assign intermediate_label = crumb_page.breadcrumb_title | default: crumb_page.title | default: base_label -%}
                {%- assign label = intermediate_label -%}
                {%- if label contains '|' -%}
                  {%- assign label = label | split: '|' | first -%}
                {%- endif -%}
                {%- assign label = label | strip -%}
                {%- if label == '' -%}
                  {%- assign label = base_label -%}
                {%- endif -%}
              {%- else -%}
                {%- assign label = base_label -%}
              {%- endif -%}
            {%- endif -%}
            {%- assign is_external = crumb_href contains '://' -%}
            {%- if is_external -%}
              {%- assign crumb_relative = crumb_href -%}
              {%- assign crumb_absolute = crumb_href -%}
            {%- else -%}
              {%- assign crumb_relative = crumb_href | relative_url -%}
              {%- assign crumb_absolute = crumb_href | absolute_url -%}
            {%- endif -%}
            <li class="breadcrumbs-item ts-breadcrumbs__item" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
              {%- if is_last_segment -%}
                <span class="breadcrumbs-current ts-breadcrumbs__current ts-crumb-current" aria-current="page" itemprop="name">{{ label }}</span>
                <meta itemprop="item" content="{{ crumb_absolute }}">
              {%- else -%}
                <a class="breadcrumbs-link ts-breadcrumbs__link ts-crumb-link" href="{{ crumb_relative }}" itemprop="item">
                  <span itemprop="name">{{ label }}</span>
                </a>
              {%- endif -%}
              <meta itemprop="position" content="{{ crumb_position }}">
            </li>
            {%- assign crumb_entry = '{"@type":"ListItem","position":' | append: crumb_position | append: ',"name":' | append: label | strip | jsonify | append: ',"item":' | append: crumb_absolute | strip | jsonify | append: '}' -%}
            {%- assign json_items = json_items | append: json_sep | append: crumb_entry -%}
            {%- assign json_sep = ',' -%}
            {%- assign crumb_position = crumb_position | plus: 1 -%}
          {%- endfor -%}
        </ol>
      </nav>
    </div>

    <script type="application/ld+json">
    {"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{{ json_items }}]}
    </script>
  {%- endif -%}
=======
  {%- assign clean_url = page.url | default: '' | replace: 'index.html', '' | replace: '.html', '' -%}
  {%- assign segments = clean_url | split: '/' -%}
  {%- assign clean_segments = '' | split: '' -%}
  {%- for seg in segments -%}
    {%- unless seg == '' -%}
      {%- assign clean_segments = clean_segments | push: seg -%}
    {%- endunless -%}
  {%- endfor -%}

  {%- assign parent_url = page.parent | default: page.breadcrumb_parent -%}
  {%- assign parent_page = nil -%}
  {%- assign parent_label = nil -%}
  {%- assign parent_parts = '' | split: '' -%}
  {%- assign parent_path = '' -%}
  {%- if parent_url and parent_url != '' -%}
    {%- assign parent_page = site.html_pages | where_exp: 'p', 'p.url == parent_url' | first -%}
    {%- assign parent_label = parent_page.breadcrumb_title | default: parent_page.hero_title | default: parent_page.title | default: page.parent_title | default: page.parent_label -%}
    {%- assign parent_parts = parent_url | replace: 'index.html', '' | replace: '.html', '' | split: '/' -%}
    {%- if parent_label == nil -%}
      {%- assign parent_label = parent_url | replace: 'index.html', '' | replace: '.html', '' | split: '/' | last | replace: '-', ' ' | capitalize -%}
    {%- endif -%}
    {%- for part in parent_parts -%}
      {%- unless part == '' -%}
        {%- assign parent_path = parent_path | append: '/' | append: part -%}
      {%- endunless -%}
    {%- endfor -%}
  {%- endif -%}

  <nav class="ts-breadcrumbs" aria-label="Breadcrumb" role="navigation" itemscope itemtype="https://schema.org/BreadcrumbList">
    <ol>
      {%- assign crumb_position = 1 -%}
      <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a class="ts-crumb-link" href="{{ '/' | relative_url }}" itemprop="item">
          <span itemprop="name">Home</span>
        </a>
        <meta itemprop="position" content="{{ crumb_position }}">
      </li>

      {%- assign crumb_position = crumb_position | plus: 1 -%}
      {%- assign current_path = '' -%}

      {%- if parent_url -%}
        {%- assign current_path = parent_path -%}
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a class="ts-crumb-link" href="{{ current_path | append: '/' | relative_url }}" itemprop="item">
            <span itemprop="name">{{ parent_label }}</span>
          </a>
          <meta itemprop="position" content="{{ crumb_position }}">
        </li>
        {%- assign crumb_position = crumb_position | plus: 1 -%}
      {%- endif -%}

      {%- assign parent_slug = parent_parts | last -%}
      {%- for segment in clean_segments -%}
        {%- if parent_url and segment == parent_slug -%}
          {%- continue -%}
        {%- endif -%}
        {%- assign current_path = current_path | append: '/' | append: segment -%}
        {%- assign is_last = forloop.last -%}
        {%- assign label = segment | replace: '-', ' ' | capitalize -%}
        {%- if is_last -%}
          {%- assign label = page.breadcrumb_title | default: page.hero_title | default: page.title | default: label -%}
        {%- endif -%}
        {%- assign crumb_href = current_path | append: '/' -%}
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a class="ts-crumb-link {% if is_last %}ts-crumb-current{% endif %}" href="{{ crumb_href | relative_url }}" itemprop="item" {% if is_last %}aria-current="page"{% endif %}>
            <span itemprop="name">{{ label }}</span>
          </a>
          <meta itemprop="position" content="{{ crumb_position }}">
        </li>
        {%- assign crumb_position = crumb_position | plus: 1 -%}
      {%- endfor -%}
    </ol>
  </nav>

  {%- comment -%} JSON-LD breadcrumb trail {%- endcomment -%}
  {%- assign json_items = '' -%}
  {%- assign json_items = json_items | append: '{"@type":"ListItem","position":1,"name":"Home","item":"' | append: site.url | append: '/"}' -%}
  {%- assign crumb_position = 2 -%}
  {%- if parent_url -%}
    {%- assign parent_item_url = site.url | append: parent_path | append: '/' -%}
    {%- assign json_items = json_items | append: ',{"@type":"ListItem","position":' | append: crumb_position | append: ',"name":"' | append: parent_label | append: '","item":"' | append: parent_item_url | append: '"}' -%}
    {%- assign crumb_position = crumb_position | plus: 1 -%}
  {%- endif -%}
  {%- assign current_path = parent_path -%}
  {%- for segment in clean_segments -%}
    {%- if parent_url and segment == parent_slug -%}
      {%- continue -%}
    {%- endif -%}
    {%- assign current_path = current_path | append: '/' | append: segment -%}
    {%- assign is_last = forloop.last -%}
    {%- assign label = segment | replace: '-', ' ' | capitalize -%}
    {%- if is_last -%}
      {%- assign label = page.breadcrumb_title | default: page.hero_title | default: page.title | default: label -%}
    {%- endif -%}
    {%- assign item_url = site.url | append: current_path | append: '/' -%}
    {%- assign json_items = json_items | append: ',{"@type":"ListItem","position":' | append: crumb_position | append: ',"name":"' | append: label | append: '","item":"' | append: item_url | append: '"}' -%}
    {%- assign crumb_position = crumb_position | plus: 1 -%}
  {%- endfor -%}
  <script type="application/ld+json">
  {"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{{ json_items }}]}
  </script>
>>>>>>> cd94431d4595c868507e3ce0fccbb2a3869edcde
{%- endif -%}
{% endunless %}

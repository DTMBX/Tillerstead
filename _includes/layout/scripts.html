<!-- Accessibility Initialization - Load FIRST -->
<script src="/assets/js/a11y-init.js"></script>

<!-- Mobile Enhancer - Load Early -->
<script src="/assets/js/mobile-enhancer.js"></script>

<!-- Unified Navigation System -->
<script src="/assets/js/unified-navigation.js"></script>
<script src="/assets/js/navigation.js"></script>

<!-- Scroll Fix (mobile nav only) -->
<script src="/assets/js/scroll-fix.js"></script>

<!-- Revenue Generation System -->
<script src="/assets/js/sticky-cta.js" defer></script>
<script src="/assets/js/lead-magnet-system.js" defer></script>

<!-- UX Enhancements -->
<script src="/assets/js/ux-enhancements.js" defer></script>

{% comment %} JavaScript Assets - Core and feature-specific scripts Loads all
JavaScript modules with cache busting and proper defer/async attributes {%
endcomment %} {% assign cache_version = site.cache_version | default:
'2026-01-18.1' %}

<!-- Core JavaScript (ES Module) -->
<script
  type="module"
  src="{{ '/assets/js/main.js' | relative_url }}?v={{ cache_version }}"
></script>

<!-- Header behavior -->
<script
  src="{{ '/assets/js/header-premium.js' | relative_url }}?v={{ cache_version }}"
  defer
></script>

<!-- Contact form handler -->
<script
  src="{{ '/assets/js/contact-form-handler.js' | relative_url }}?v={{ cache_version }}"
  defer
></script>
<script
  src="{{ '/assets/js/gestures.js' | relative_url }}?v={{ cache_version }}"
  defer
></script>
<script
  src="{{ '/assets/js/app-shell.js' | relative_url }}?v={{ cache_version }}"
  defer
></script>
<script
  src="{{ '/assets/js/mobile-personality.js' | relative_url }}?v={{ cache_version }}"
  defer
></script>

<!-- Build Phase Calculators (conditionally loaded) -->
{% if page.url contains '/build/' %}
<script
  src="{{ '/assets/js/build-calculators.js' | relative_url }}?v={{ cache_version }}"
  defer
></script>
{% endif %}

<!-- Legacy Tools (Estimate Builder + Export) -->
{% if page.url contains '/tools/legacy/' %}
<script
  src="{{ '/assets/js/tools.js' | relative_url }}?v={{ cache_version }}"
  defer
></script>
{% endif %}
<!-- Table of contents builder -->
<script>
(function () {
  const toc = document.querySelector('[data-toc]');
  if (!toc) return;

  const scopeSel = toc.dataset.tocScope || 'main';
  const scope = document.querySelector(scopeSel);
  if (!scope) return;

  const headings = scope.querySelectorAll('h2, h3');
  if (!headings.length) return;

  const ul = document.createElement('ul');
  ul.className = 'toc__list';

  headings.forEach(h => {
    if (!h.id) return;

    const li = document.createElement('li');
    li.className = 'toc__item level-' + h.tagName.replace('H','');

    const a = document.createElement('a');
    a.className = 'toc__link';
    a.href = '#' + h.id;
    a.textContent = h.textContent;

    li.appendChild(a);
    ul.appendChild(li);
  });

  toc.appendChild(ul);
})();
</script>
{% if jekyll.environment == 'development' %}
<!-- Development overlay for debugging -->
<script
  src="{{ '/assets/js/dev-overlay.js' | relative_url }}?v={{ cache_version }}"
  defer
></script>
{% endif %}


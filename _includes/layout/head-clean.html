<!-- Jekyll include: no DOCTYPE needed -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=yes, maximum-scale=5.0, minimum-scale=0.5" />

<!-- Modern device hints -->
<meta name="mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="format-detection" content="telephone=yes" />
<meta name="HandheldFriendly" content="true" />

<!-- Security Headers (Client-Side) -->
<meta http-equiv="X-Content-Type-Options" content="nosniff" />
<meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin" />
<meta http-equiv="Permissions-Policy" content="geolocation=(), microphone=(), camera=()" />

<meta name="color-scheme" content="light dark" />
<meta name="theme-color" content="#10b981" media="(prefers-color-scheme: light)" />
<meta name="theme-color" content="#059669" media="(prefers-color-scheme: dark)" />

<!-- Early accessibility preference detection -->
<script>
(function(){
  var d=document.documentElement,m=globalThis.matchMedia;
  if(m('(prefers-reduced-motion:reduce)').matches)d.classList.add('reduce-motion');
  if(m('(forced-colors:active)').matches||m('(prefers-contrast:more)').matches)d.dataset.highContrast='true';
  if(m('(prefers-color-scheme:dark)').matches)d.dataset.colorScheme='dark';
  if(m('(pointer:coarse)').matches){d.dataset.pointer='coarse';d.classList.add('touch-friendly');}
  if(m('(hover:none)').matches)d.dataset.hover='none';
  try{var p=JSON.parse(localStorage.getItem('tillerstead-a11y-prefs')||'{}');
    if(p.highContrast)d.dataset.highContrast='true';
    if(p.textSize)d.dataset.textSize=p.textSize;
    if(p.reducedMotion)d.classList.add('reduce-motion');
  }catch(e){if(typeof console!=='undefined'&&console.warn)console.warn('Unable to load preferences:',e.message);}
})();
</script>

<title>{% if page.meta_title %}{{ page.meta_title | strip | escape }}{% elsif page.title %}{{ page.title | strip | escape }} | {{ site.title | strip | escape }}{% else %}{{ site.title | strip | escape }}{% endif %}</title>

{% if page.meta_description %}
<meta name="description" content="{{ page.meta_description | strip_html | strip_newlines | truncate: 160 | escape }}" />
{% elsif page.description %}
<meta name="description" content="{{ page.description | strip_html | strip_newlines | truncate: 160 | escape }}" />
{% elsif site.description %}
<meta name="description" content="{{ site.description | strip_html | strip_newlines | truncate: 160 | escape }}" />
{% endif %}

{% if page.keywords %}
<meta name="keywords" content="{{ page.keywords | join: ', ' | escape }}" />
{% elsif site.keywords %}
<meta name="keywords" content="{{ site.keywords | join: ', ' | escape }}" />
{% endif %}

<meta name="author" content="Tillerstead LLC" />
<meta name="robots" content="{{ page.robots | default: 'index, follow' }}" />

<!-- Performance Resource Hints -->
<link rel="dns-prefetch" href="//www.google-analytics.com" />
<link rel="dns-prefetch" href="//www.googletagmanager.com" />
<link rel="dns-prefetch" href="//fonts.gstatic.com" />
<link rel="preconnect" href="https://www.thumbtack.com" crossorigin />
<link rel="preconnect" href="https://fonts.googleapis.com" crossorigin />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

<!-- Preload Critical Assets -->
<link rel="preload" as="style" href="{{ '/assets/css/root-vars.css' | relative_url }}" />
<link rel="preload" as="style" href="{{ '/assets/css/critical.css' | relative_url }}" />
<link rel="preload" as="script" href="{{ '/assets/js/main.js' | relative_url }}" />

<!-- Prefetch next likely pages -->
{% if page.is_home == true %}
<link rel="prefetch" href="{{ '/services/' | relative_url }}" />
<link rel="prefetch" href="{{ '/contact/' | relative_url }}" />
{% elsif page.url == '/services/' %}
<link rel="prefetch" href="{{ '/portfolio/' | relative_url }}" />
<link rel="prefetch" href="{{ '/contact/' | relative_url }}" />
{% endif %}

<!-- Favicons & App Icons -->
{% include icons/favicon-meta.html %}

<!-- CSS LAYER ARCHITECTURE -->
<style>
@layer reset, tokens, mobile-base, base, layout, components, utilities, page-specific;
</style>

<!-- Core CSS (Ordered by cascade layer) -->
<link rel="stylesheet" href="{{ '/assets/css/root-vars.css' | relative_url }}" />
<link rel="stylesheet" href="{{ '/assets/css/mobile-base.css' | relative_url }}" />
<link rel="stylesheet" href="{{ '/assets/css/critical.css' | relative_url }}" />
<link rel="stylesheet" href="{{ '/assets/css/supreme-flexibility.css' | relative_url }}" />
<link rel="stylesheet" href="{{ '/assets/css/main.css' | relative_url }}" />
<link rel="stylesheet" href="{{ '/assets/css/navigation.css' | relative_url }}" />
<link rel="stylesheet" href="{{ '/assets/css/components/ts-navigation.css' | relative_url }}" />
<link rel="stylesheet" href="{{ '/assets/css/footer.css' | relative_url }}" />
<link rel="stylesheet" href="{{ '/assets/css/accessibility.css' | relative_url }}" />
<link rel="stylesheet" href="{{ '/assets/css/modern-devices.css' | relative_url }}" />
<link rel="stylesheet" href="{{ '/assets/css/animations.css' | relative_url }}" />
<link rel="stylesheet" href="{{ '/assets/css/premium-animations.css' | relative_url }}" />
<link rel="stylesheet" href="{{ '/assets/css/premium-components.css' | relative_url }}" />
<link rel="stylesheet" href="{{ '/assets/css/ux-enhancements.css' | relative_url }}" />

<!-- Component CSS -->
<link rel="stylesheet" href="{{ '/assets/css/components/colors-backgrounds.css' | relative_url }}" />
<link rel="stylesheet" href="{{ '/assets/css/components/buttons-enhanced.css' | relative_url }}" />
<link rel="stylesheet" href="{{ '/assets/css/components/hero.css' | relative_url }}" />
<link rel="stylesheet" href="{{ '/assets/css/components/page-heroes.css' | relative_url }}" />
<link rel="stylesheet" href="{{ '/assets/css/components/typography.css' | relative_url }}" />
<link rel="stylesheet" href="{{ '/assets/css/components/cards.css' | relative_url }}" />
<link rel="stylesheet" href="{{ '/assets/css/components/spacing.css' | relative_url }}" />
<link rel="stylesheet" href="{{ '/assets/css/components/section-cards.css' | relative_url }}" />
<link rel="stylesheet" href="{{ '/assets/css/components/sticky-cta.css' | relative_url }}" />
<link rel="stylesheet" href="{{ '/assets/css/components/service-cards.css' | relative_url }}" />
<link rel="stylesheet" href="{{ '/assets/css/components/forms.css' | relative_url }}" />

<!-- Page-specific CSS -->
{% if page.url == '/' %}
<link rel="stylesheet" href="{{ '/assets/css/pages/home.css' | relative_url }}" />
{% endif %}
{% if page.layout == 'build-page' %}
<link rel="stylesheet" href="{{ '/assets/css/build-guide.css' | relative_url }}" />
{% endif %}
{% if page.url == '/homeowner-resources/' %}
<link rel="stylesheet" href="{{ '/assets/css/pages/resources.css' | relative_url }}" />
{% endif %}
{% if page.url == '/tile-visualizer.html' %}
<link rel="stylesheet" href="{{ '/assets/css/tile-visualizer.css' | relative_url }}" />
{% endif %}

<!-- Page custom stylesheets -->
{% if page.stylesheets %}
  {% for stylesheet in page.stylesheets %}
  <link rel="stylesheet" href="{{ stylesheet | relative_url }}" />
  {% endfor %}
{% endif %}

<!-- Page custom scripts -->
{% if page.scripts %}
  {% for script in page.scripts %}
  <script src="{{ script | relative_url }}" defer></script>
  {% endfor %}
{% endif %}

<!-- Progressive Image Loading -->
<script src="{{ '/assets/js/progressive-image.js' | relative_url }}" defer></script>

{% if page.extra_head %}{{ page.extra_head }}{% endif %}

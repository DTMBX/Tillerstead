{% comment %}
  Responsive Image Component with AVIF/WebP/fallback support
  Usage: {% include components/picture.html 
           src="assets/img/photo.jpg" 
           alt="Description" 
           width="800" 
           height="600"
           loading="lazy"
           class="my-class" %}
{% endcomment %}

{% assign img_base = include.src | remove: '.jpg' | remove: '.jpeg' | remove: '.png' %}
{% assign img_ext = include.src | split: '.' | last %}

<picture{% if include.class %} class="{{ include.class }}"{% endif %}>
  {%- comment -%} AVIF - Best compression (Chrome 85+, Firefox 93+, Edge 121+) {%- endcomment -%}
  <source srcset="{{ img_base }}.avif" type="image/avif">
  
  {%- comment -%} WebP - Good compression (Chrome 23+, Safari 14+, Firefox 65+) {%- endcomment -%}
  <source srcset="{{ img_base }}.webp" type="image/webp">
  
  {%- comment -%} Fallback - Universal support {%- endcomment -%}
  <img src="{{ include.src }}" 
       alt="{{ include.alt | default: '' }}"
       {% if include.width %}width="{{ include.width }}"{% endif %}
       {% if include.height %}height="{{ include.height }}"{% endif %}
       {% if include.loading %}loading="{{ include.loading }}"{% else %}loading="lazy"{% endif %}
       {% if include.fetchpriority %}fetchpriority="{{ include.fetchpriority }}"{% endif %}
       {% if include.decoding %}decoding="{{ include.decoding }}"{% else %}decoding="async"{% endif %}
       {% if include.class %}class="{{ include.class }}"{% endif %}>
</picture>

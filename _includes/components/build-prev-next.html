{% assign build_pages = site.build | where_exp: "p", "p.build_order" | sort: "build_order" %}

{% assign idx = nil %}

{% for p in build_pages %}
  {% if p.url == page.url %}
    {% assign idx = forloop.index0 %}
  {% endif %}
{% endfor %}

{% if idx != nil %}
  {% assign prev_i = idx | minus: 1 %}
  {% assign next_i = idx | plus: 1 %}
  {% assign prev_p = build_pages[prev_i] %}
  {% assign next_p = build_pages[next_i] %}

  <nav class="build-prev-next" aria-label="Build phase navigation">
    <div class="build-prev-next__grid">
      {% if prev_p %}
        <a class="build-prev-next__card build-prev-next__card--prev" href="{{ prev_p.url | relative_url }}">
          <span class="build-prev-next__eyebrow">Previous</span>
          <span class="build-prev-next__title">Step {{ prev_p.build_order }}: {{ prev_p.title }}</span>
        </a>
      {% else %}
        <div class="build-prev-next__card build-prev-next__card--empty" aria-hidden="true"></div>
      {% endif %}

      {% if next_p %}
        <a class="build-prev-next__card build-prev-next__card--next" href="{{ next_p.url | relative_url }}">
          <span class="build-prev-next__eyebrow">Next</span>
          <span class="build-prev-next__title">Step {{ next_p.build_order }}: {{ next_p.title }}</span>
        </a>
      {% else %}
        <div class="build-prev-next__card build-prev-next__card--empty" aria-hidden="true"></div>
      {% endif %}
    </div>
  </nav>
{% endif %}


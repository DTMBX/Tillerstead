<!-- MODULE 3: MORTAR / TROWEL CALCULATOR -->
<section class="tools-section" id="mortar-calculator" aria-labelledby="mortar-calculator-title">
  <div class="container">
    <header class="tools-section__header">
      <h2 id="mortar-calculator-title" class="tools-section__title">Mortar & Trowel Calculator</h2>
      <p class="tools-section__desc">Estimate mortar quantity with auto-recommended trowel notch based on tile size and substrate.</p>
    </header>

    <div class="tools-card">
      <div class="form-grid form-grid--3col">
        <div class="form-field">
          <label for="mortar-area" class="form-label form-label--required">Area</label>
          <div class="form-inline">
            <input type="number" id="mortar-area" class="form-input" placeholder="0" min="1" step="0.1" required>
            <span class="form-inline__suffix">sq ft</span>
          </div>
        </div>
        <div class="form-field">
          <label for="mortar-tile-size" class="form-label">Tile Size</label>
          <select id="mortar-tile-size" class="form-select">
            <option value="">Select tile size...</option>
          </select>
        </div>
        <div class="form-field" id="mortar-custom-tile-fields" hidden>
          <label class="form-label">Custom Size (inches)</label>
          <div class="form-inline">
            <input type="number" id="mortar-custom-width" class="form-input form-input--sm" placeholder="W" min="1" step="0.25">
            <span class="form-inline__sep">×</span>
            <input type="number" id="mortar-custom-height" class="form-input form-input--sm" placeholder="H" min="1" step="0.25">
          </div>
        </div>
      </div>

      {% include components/c-sqft-helper.html title="Sq Ft Helper (Tile Area)" targetFloor="#mortar-area" %}

      <div class="form-grid form-grid--3col">
        <div class="form-field">
          <label for="mortar-substrate" class="form-label">Substrate Condition</label>
          <select id="mortar-substrate" class="form-select">
            <option value="smooth">Smooth / Flat</option>
            <option value="typical" selected>Typical (minor variation)</option>
            <option value="needs-flattening">Needs Flattening</option>
          </select>
        </div>
        <div class="form-field">
          <label for="mortar-coverage-goal" class="form-label">Coverage Goal</label>
          <select id="mortar-coverage-goal" class="form-select">
            <option value="dry-floor">Dry Floor (80%+)</option>
            <option value="wet-area" selected>Wet Area (95%+)</option>
            <option value="large-format">Large Format (95%+, back-butter)</option>
          </select>
        </div>
        <div class="form-field">
          <label for="mortar-trowel" class="form-label">Trowel Notch</label>
          <select id="mortar-trowel" class="form-select">
            <option value="">Auto-recommend...</option>
          </select>
          <span class="form-hint" id="trowel-hint">Will auto-recommend based on tile size</span>
        </div>
      </div>

      <div class="form-grid form-grid--2col">
        <div class="form-field">
          <label class="form-checkbox">
            <input type="checkbox" id="mortar-backbutter">
            <span class="form-checkbox__text">Back-butter tiles</span>
          </label>
          <span class="form-hint">Recommended for large-format tile</span>
        </div>
        <div class="form-field" id="mortar-trowel-override-reason-field" hidden>
          <label for="mortar-trowel-override-reason" class="form-label form-label--sm">Reason for override</label>
          <input type="text" id="mortar-trowel-override-reason" class="form-input" placeholder="Why a different notch?">
        </div>
      </div>

      <!-- Trowel Recommendation -->
      <div class="recommendation" id="trowel-recommendation" hidden>
        <strong>Auto-Recommended:</strong> <span id="trowel-recommendation-text"></span>
        <p class="recommendation__note">This is a starting-point recommendation. Verify with tile/mortar manufacturer and confirm coverage in the field.</p>
      </div>

      <!-- Selected vs Recommended Display -->
      <div class="trowel-comparison" id="trowel-comparison" hidden>
        <div class="trowel-comparison__item">
          <span class="trowel-comparison__label">Recommended</span>
          <span class="trowel-comparison__value" id="trowel-recommended-display">—</span>
        </div>
        <div class="trowel-comparison__item trowel-comparison__item--selected">
          <span class="trowel-comparison__label">Selected</span>
          <span class="trowel-comparison__value" id="trowel-selected-display">—</span>
        </div>
      </div>

      <!-- Substrate Nudge -->
      <div class="nudge" id="substrate-nudge" hidden role="alert" aria-live="polite">
        <svg aria-hidden="true" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/>
        </svg>
        <span id="substrate-nudge-text"></span>
      </div>

      <!-- Back-butter Nudge -->
      <div class="nudge nudge--info" id="backbutter-nudge" hidden role="alert" aria-live="polite">
        <svg aria-hidden="true" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/>
        </svg>
        <span>Large-format tile (any side ≥24"): Consider back-buttering for better coverage.</span>
      </div>

      <button type="button" class="btn btn--primary" id="calc-mortar-btn">Calculate Mortar</button>

      <!-- Results -->
      <div class="calc-results" id="mortar-calc-results" hidden>
        <h4 class="calc-results__title">Estimated Mortar Needed</h4>
        <div class="calc-results__grid">
          <div class="calc-result">
            <span class="calc-result__label">Trowel notch</span>
            <span class="calc-result__value" id="result-trowel">—</span>
          </div>
          <div class="calc-result">
            <span class="calc-result__label">Coverage range</span>
            <span class="calc-result__value" id="result-coverage">—</span>
          </div>
          <div class="calc-result">
            <span class="calc-result__label">50 lb bags needed</span>
            <span class="calc-result__value calc-result__value--highlight" id="result-bags">—</span>
          </div>
        </div>
        <p class="calc-results__note">Coverage varies by troweling technique, substrate conditions, and mortar type. Confirm with manufacturer data sheets. If back-buttering, increase estimate by 20–30%.</p>
      </div>
    </div>
  </div>
</section>
